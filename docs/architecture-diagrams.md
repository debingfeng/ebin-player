# Ebin Player 架构图表

## 整体架构图

```
┌─────────────────────────────────────────────────────────────┐
│                    用户接口层                                │
│  ┌─────────────────────────────────────────────────────┐    │
│  │              PlayerInstance API                     │    │
│  │  - play() / pause() / destroy()                    │    │
│  │  - on() / off() / emit()                           │    │
│  │  - use() / unuse() / getPlugin()                   │    │
│  └─────────────────────────────────────────────────────┘    │
└─────────────────────────────────────────────────────────────┘
                                │
                                ▼
┌─────────────────────────────────────────────────────────────┐
│                    核心业务层                                │
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────────────┐  │
│  │ PlayerCore  │  │PlayerStore  │  │   PluginManager     │  │
│  │- 视频控制   │  │- 状态管理   │  │- 插件注册/注销      │  │
│  │- 事件处理   │  │- 状态订阅   │  │- 插件生命周期       │  │
│  │- UI模式管理 │  │- 状态通知   │  │- 插件上下文        │  │
│  └─────────────┘  └─────────────┘  └─────────────────────┘  │
└─────────────────────────────────────────────────────────────┘
                                │
                                ▼
┌─────────────────────────────────────────────────────────────┐
│                    UI表现层                                  │
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────────────┐  │
│  │  UIManager  │  │ThemeManager │  │ ResponsiveManager   │  │
│  │- 组件管理   │  │- 主题切换   │  │- 响应式布局         │  │
│  │- 渲染控制   │  │- 样式管理   │  │- 断点检测           │  │
│  │- 生命周期   │  │- 主题应用   │  │- 组件适配           │  │
│  └─────────────┘  └─────────────┘  └─────────────────────┘  │
└─────────────────────────────────────────────────────────────┘
                                │
                                ▼
┌─────────────────────────────────────────────────────────────┐
│                    组件层                                   │
│  ┌─────────────────────────────────────────────────────────┐ │
│  │                BaseComponent                           │ │
│  │  ┌─────────────┐ ┌─────────────┐ ┌─────────────────────┐ │ │
│  │  │ PlayButton  │ │ProgressBar  │ │   VolumeControl     │ │ │
│  │  └─────────────┘ └─────────────┘ └─────────────────────┘ │ │
│  │  ┌─────────────┐ ┌─────────────┐                       │ │
│  │  │ TimeDisplay │ │ 其他组件... │                       │ │
│  │  └─────────────┘ └─────────────┘                       │ │
│  └─────────────────────────────────────────────────────────┘ │
└─────────────────────────────────────────────────────────────┘
                                │
                                ▼
┌─────────────────────────────────────────────────────────────┐
│                    插件层                                   │
│  ┌─────────────────────────────────────────────────────────┐ │
│  │                 BasePlugin                             │ │
│  │  ┌─────────────────────────────────────────────────────┐ │ │
│  │  │            PlaybackRatePlugin                      │ │ │
│  │  │  - 播放速度控制                                    │ │ │
│  │  │  - 速度选项配置                                    │ │ │
│  │  └─────────────────────────────────────────────────────┘ │ │
│  │  ┌─────────────────────────────────────────────────────┐ │ │
│  │  │              自定义插件...                          │ │ │
│  │  └─────────────────────────────────────────────────────┘ │ │
│  └─────────────────────────────────────────────────────────┘ │
└─────────────────────────────────────────────────────────────┘
                                │
                                ▼
┌─────────────────────────────────────────────────────────────┐
│                  基础设施层                                  │
│  ┌─────────────┐  ┌─────────────────────────────────────────┐ │
│  │   Logger    │  │         HTMLVideoElement               │ │
│  │- 日志记录   │  │- 原生视频播放                          │ │
│  │- 调试支持   │  │- 媒体事件                              │ │
│  │- 性能监控   │  │- 浏览器API                             │ │
│  └─────────────┘  └─────────────────────────────────────────┘ │
└─────────────────────────────────────────────────────────────┘
```

## 数据流图

```
用户操作
    │
    ▼
┌─────────────┐    ┌─────────────┐    ┌─────────────────┐
│ PlayerInstance │───▶│  PlayerCore  │───▶│ HTMLVideoElement│
│ (API层)      │    │ (核心逻辑)   │    │ (原生视频)      │
└─────────────┘    └─────────────┘    └─────────────────┘
    │                      │                      │
    │                      ▼                      │
    │              ┌─────────────┐                │
    │              │ PlayerStore │                │
    │              │ (状态管理)  │                │
    │              └─────────────┘                │
    │                      │                      │
    ▼                      ▼                      ▼
┌─────────────┐    ┌─────────────┐    ┌─────────────────┐
│  UIManager  │    │ 状态更新    │    │ 媒体事件        │
│ (UI管理)    │    │ 通知订阅者  │    │ 触发回调        │
└─────────────┘    └─────────────┘    └─────────────────┘
    │
    ▼
┌─────────────┐
│ UI组件更新  │
│ 重新渲染    │
└─────────────┘
```

## 插件系统架构图

```
┌─────────────────────────────────────────────────────────────┐
│                   插件系统架构                               │
│                                                             │
│  ┌─────────────┐    ┌─────────────┐    ┌─────────────────┐  │
│  │PluginManager│    │PluginContext│    │  PluginDefinition│  │
│  │- 插件注册   │    │- 插件上下文 │    │- 插件元数据     │  │
│  │- 生命周期   │    │- 服务定位   │    │- 插件实现       │  │
│  │- 依赖管理   │    │- 事件系统   │    │- 配置验证       │  │
│  └─────────────┘    └─────────────┘    └─────────────────┘  │
│         │                   │                   │          │
│         └───────────────────┼───────────────────┘          │
│                             │                              │
│  ┌─────────────────────────────────────────────────────────┐ │
│  │                插件生命周期                              │ │
│  │  onInit() → onStart() → onEvent() → onDestroy()        │ │
│  └─────────────────────────────────────────────────────────┘ │
│                                                             │
│  ┌─────────────────────────────────────────────────────────┐ │
│  │                插件能力                                  │ │
│  │  - 事件监听和处理                                        │ │
│  │  - 状态订阅和修改                                        │ │
│  │  - UI组件注入                                           │ │
│  │  - 服务注册和发现                                        │ │
│  │  - 配置管理和持久化                                      │ │
│  └─────────────────────────────────────────────────────────┘ │
└─────────────────────────────────────────────────────────────┘
```

## 组件关系图

```
┌─────────────────────────────────────────────────────────────┐
│                    UI组件系统                               │
│                                                             │
│  ┌─────────────┐                                            │
│  │  UIManager  │                                            │
│  │ (组件管理器)│                                            │
│  └─────────────┘                                            │
│         │                                                   │
│         ▼                                                   │
│  ┌─────────────────────────────────────────────────────────┐ │
│  │              BaseComponent                             │ │
│  │  ┌─────────────┐ ┌─────────────┐ ┌─────────────────────┐ │ │
│  │  │ PlayButton  │ │ProgressBar  │ │   VolumeControl     │ │ │
│  │  │- 播放/暂停  │ │- 进度显示   │ │- 音量控制           │ │ │
│  │  │- 状态同步   │ │- 拖拽交互   │ │- 静音切换           │ │ │
│  │  └─────────────┘ └─────────────┘ └─────────────────────┘ │ │
│  │  ┌─────────────┐ ┌─────────────┐ ┌─────────────────────┐ │ │
│  │  │ TimeDisplay │ │FullscreenBtn│ │  其他自定义组件...  │ │ │
│  │  │- 时间显示   │ │- 全屏切换   │ │- 用户扩展组件       │ │ │
│  │  │- 格式转换   │ │- 状态管理   │ │- 第三方组件         │ │ │
│  │  └─────────────┘ └─────────────┘ └─────────────────────┘ │ │
│  └─────────────────────────────────────────────────────────┘ │
│                                                             │
│  ┌─────────────────────────────────────────────────────────┐ │
│  │                主题系统                                  │ │
│  │  ThemeManager → ComponentTheme → 样式应用               │ │
│  └─────────────────────────────────────────────────────────┘ │
│                                                             │
│  ┌─────────────────────────────────────────────────────────┐ │
│  │                响应式系统                                │ │
│  │  ResponsiveManager → 断点检测 → 组件适配                │ │
│  └─────────────────────────────────────────────────────────┘ │
└─────────────────────────────────────────────────────────────┘
```
